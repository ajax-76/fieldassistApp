using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;
using OfficeOpenXml;
using DataUpload.Controllers;


namespace ConsoleApplication1
{
    class Program
    {        
        public static void DataRead(string Path)
        {
            ValidationChecker mapChecker = new ValidationChecker();
            List<string> fileHeaders = new List<string>();
              fileHeaders.Add("NSM");                //---------------------cell1
              fileHeaders.Add("NSMZone");
            fileHeaders.Add("FinalBeatName");
            fileHeaders.Add("ZSM");
            fileHeaders.Add("BeatState");          //---------------------cell25
            fileHeaders.Add("BeatZone");           //---------------------cell26
            fileHeaders.Add("DistributorName");
            fileHeaders.Add("DistributorErpId");
            //---------------------cell2
            /*   fileHeaders.Add("NSMEmailId");         //---------------------cell3
               fileHeaders.Add("NSMSecondaryEmailId");//---------------------cell4
               fileHeaders.Add("ZSM");                //---------------------cell5
               fileHeaders.Add("ZSMEmailId");         //---------------------cell6
               fileHeaders.Add("ZSMZone");            //---------------------cell7
               fileHeaders.Add("ZSMSecondaryEmailId");//---------------------cell8
               fileHeaders.Add("RSM");                //---------------------cell9
               fileHeaders.Add("RSMEmailId");         //---------------------cell10
               fileHeaders.Add("RSMSecondaryEmailId");//---------------------cell11
               fileHeaders.Add("ASM");                //---------------------cell12
               fileHeaders.Add("ASMEmailId");         //---------------------cell13
               fileHeaders.Add("ASMZone");            //---------------------cell14
               fileHeaders.Add("ASMSecondaryEmailId");//---------------------cell15
               fileHeaders.Add("ESM");                //---------------------cell16
               fileHeaders.Add("ESMEmailId");         //---------------------cell17
               fileHeaders.Add("ESMZone");            //---------------------cell18
               fileHeaders.Add("ESMSecondaryEmailId");//---------------------cell19
               fileHeaders.Add("ESMContactNumber");   //---------------------cell20
               fileHeaders.Add("ESMHQ");              //---------------------cell21
               fileHeaders.Add("FinalBeatName");      //---------------------cell22
               fileHeaders.Add("BeatErpId");          //---------------------cell23
               fileHeaders.Add("BeatDistrict");       //---------------------cell24
               fileHeaders.Add("BeatState");          //---------------------cell25
               fileHeaders.Add("BeatZone");           //---------------------cell26
               fileHeaders.Add("DistributorName");    //---------------------cell27
               fileHeaders.Add("DistributorLocation");//---------------------cell28
               fileHeaders.Add("DistributorErpId");   //---------------------cell29
               fileHeaders.Add("DistributorEmailId"); //---------------------cell20*/
            try
            {
                var file = new FileInfo(Path);
                ExcelPackage package = new ExcelPackage(file);
                ExcelWorksheet sheet = package.Workbook.Worksheets[1];
                var header = sheet.Cells[1, 1, 1, sheet.Dimension.End.Column];
                var fileField = sheet.Cells[sheet.Dimension.Start.Row, sheet.Dimension.Start.Column, sheet.Dimension.End.Row, sheet.Dimension.End.Column];
                List<string> headerCheck = new List<string>();

                List<FileHeaders> list = new List<FileHeaders>();

                for (int i = sheet.Dimension.Start.Row; i < sheet.Dimension.End.Row; i++)
                {
                    FileHeaders records = new FileHeaders();
                    for (int j = sheet.Dimension.Start.Column - 1; j < sheet.Dimension.End.Column; j++)
                    {
                        var value = ((object[,])fileField.Value)[0, j];
                        if (value != null)
                        {
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "NSM".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.NSM = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.NSM = "";
                                }
                                

                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "NSMZone".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.NSMZone = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.NSMZone = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "NSMEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.NSMEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.NSMEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "NSMSecondaryEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.NSMSecondaryEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.NSMSecondaryEmailId = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ZSM".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ZSM = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ZSM = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ZSMZone".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ZSMZone = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ZSMZone = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ZSMEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ZSMEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ZSMEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ZSMSecondaryEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ZSMSecondaryEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ZSMSecondaryEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "RSM".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.RSM = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.RSM = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "RSMZone".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.RSMZone = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.RSMZone = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "RSMEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.RSMEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.RSMEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "RSMSecondaryEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.RSMSecondaryEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.RSMSecondaryEmailId = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ASM".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ASM = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ASM = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ASMZone".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ASMZone = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ASMZone = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ASMEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ASMEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ASMEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ASMSecondaryEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ASMSecondaryEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ASMSecondaryEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ESM".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ESM = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ESM = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ESMEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ESMEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ESMEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ESMSecondaryEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ESMSecondaryEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ESMSecondaryEmailId = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ESMZone".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ESMZone = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ESMZone = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ESMContactNumber".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ESMContactNumber = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ESMContactNumber = "";
                                }
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ESMHQ".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ESMHQ = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ESMHQ = "";
                                }
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "ESMErpId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.ESMErpId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.ESMErpId = "";
                                }
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "FinalBeatName".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.FinalBeatName = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.FinalBeatName = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "BeatState".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.BeatState = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.BeatState = "";
                                }
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "BeatDistrict".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.BeatDistrict = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.BeatDistrict = "";
                                }
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "BeatZone".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.BeatZone = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.BeatZone = "";
                                }
                            } 
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "BeatErpId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.BeatErpId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.BeatErpId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "DistributorName".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.DistributorName = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.DistributorName = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "DistributorLocation".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.DistributorLocation = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.DistributorLocation = "";
                                }
                               
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "DistributorEmailId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.DistributorEmailId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.DistributorEmailId = "";
                                }
                                
                            }
                            if (((object[,])fileField.Value)[0, j].ToString().Trim().Replace(" ", "").ToLower() == "DistributorErpId".ToLower())
                            {
                                if (((object[,])fileField.Value)[i, j] != null)
                                {
                                    records.DistributorErpId = ((object[,])fileField.Value)[i, j].ToString();
                                }
                                else
                                {
                                    records.DistributorErpId = "";
                                }
                                
                            }
                        }
                    }

                    records.Row = i;
                    list.Add(records);
                }
                var query = list.GroupBy(x=>x.NSM).Select(x=>new FileHeaders {NSM=x.Key,Row=x.Count()});
                foreach(var item in query)
                {
                    Console.WriteLine(item.NSM);
                    Console.WriteLine(item.Row);
                    Console.ReadKey();
                }
                //  Console.ReadKey();                
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
                Console.WriteLine("Error in file");
                Console.ReadKey();
            }
            

        }       
        static void Main(string[] args)
        {
            DataRead((@"C:\Docs\Visual Studio 2015\Projects\DataUpload\DataUpload\Seed Data\testFiles\warning1.xlsx")); 
        }
        public static void check(int one,int two)
        {
            
            
        }
    }    
}





















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































